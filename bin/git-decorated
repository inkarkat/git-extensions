#!/bin/bash
shopt -qs extglob

printUsage()
{
    cat <<HELPTEXT
Show the (short) ref names of the current / passed revision(s).
HELPTEXT
    echo
    printf 'Usage: %q %s\n' "$(basename "$1")" '[--decorate[=short|full|auto|no]] [--decorate-refs=<pattern>] [--decorate-refs-exclude=<pattern>] [--] [<commit-ish> ...] [-?|-h|--help]'
}

typeset -a logDecorateArgs=()
while [ $# -ne 0 ]
do
    case "$1" in
	--help|-h|-\?)	shift; printUsage "$0"; exit 0;;
	--decorate|--decorate=*)
			logDecorateArgs+=("$1"); shift;;
	--decorate-refs?(-exclude))
			logDecorateArgs+=("$1" "${2?}"); shift; shift;;
	--decorate-refs?(-exclude)=*)
			logDecorateArgs+=("$1"); shift;;
	--)		shift; break;;
	-*)		{ echo "ERROR: Unknown option \"$1\"!"; echo; printUsage "$0"; } >&2; exit 2;;
	*)		break;;
    esac
done
[ $# -eq 0 ] && set -- HEAD

status=0
for rev
do
    git log --max-count 1 "${logDecorateArgs[@]}" --pretty='format:%D' "$rev" -- || status=$?
done
exit $status
