#!/bin/bash
shopt -qs extglob

printUsage()
{
    cat <<HELPTEXT
One-line list of full commit hashes; useful with --grep.
HELPTEXT
    echo
    printf 'Usage: %q %s\n' "$(basename "$1")" '[<log-options>] [<revision range>] [[--] <path>...] [-?|-h|--help]'
}

typeset -a logArgs=()
hashFormat='%H'
while [ $# -ne 0 ]
do
    case "$1" in
	--help|-h|-\?)	shift; printUsage "$0"; exit 0;;
	--no-color|--color=*)
			shift;;
	--color)	shift; shift;;

	--abbrev-commit|--abbrev|--abbrev=*)
			logArgs+=("$1"); shift; hashFormat='%h';;

	# Ignore options that influence commit formatting (we need just the
	# hashes), and diff options.
	-+([cmtpuz])|-[LUX]?*)	shift;;
	--@(abbrev-commit|no-abbrev-commit|oneline|no-notes|show-signature|relative-date|parents|children|left-right|graph|cc|dd|patch|no-patch|raw|patch-with-raw|numstat|shortstat|summary|patch-with-stat|binary|name-only|name-status|check|no-color|remerge-diff|no-diff-merges))	shift;;
	-[L])	shift; shift;;
	--@(pretty|format|notes|date|unified|stat|dirstat|submodule|color|word-diff|word-diff-regex|color-words|diff-merges|output)=*)	shift;;
	--@(format|date|unified|word-diff-regex|diff-merges|output))	shift; shift;;

	--)		shift; break;;
	*)		logArgs+=("$1"); shift;;
    esac
done

exec git log --pretty="tformat:$hashFormat" "${logArgs[@]}" "$@"
