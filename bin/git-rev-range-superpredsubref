#!/bin/bash

printUsage()
{
    git-rev-range --help 2>&1 | sed \
	-e '1s#^.*$#Print / execute GIT-COMMAND with the revision range from HEAD up to the commit that was previously referenced by the superproject#' \
	-e '2,/^- /{ /^- /p; d; }' \
	-e '/^Usage:$/N' -e '/\(^\|\n\)Usage: */{ s/\(^\|\n\)\(Usage: *\)\?\([^ ]\+ \)*git-rev-range /\1\2'"$(basename "$1")"' /; s/ -r|--revision REVISION \[-e|--end-revision END-REVISION \[--last-only\]| /[/; }'
}

currentSubmodule="$(git-supersubpath)" || exit $?
superRevToCurrentSubmoduleCommit="$(git-superrev-command --first-only)" || exit $?
previouslyReferencedSubmoduleCommit="$(git-superdo --no-header subhash "${superRevToCurrentSubmoduleCommit}^" "$currentSubmodule")" || exit $?

exec git-rev-range --revision "$previouslyReferencedSubmoduleCommit" "$@"
